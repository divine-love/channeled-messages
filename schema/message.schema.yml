```yaml
$schema: "http://json-schema.org/draft-07/schema#"
$id: "https://divinelove.github.io/schema/message.schema.yml"
$title: Divine Love Message Metadata Schema
$type: object
$comment: >
  JSON Schema (draft-07) for message .yml files in /messages/YYYY/.
  The message text/body itself is stored OUTSIDE the YAML front matter (in the Markdown or after the YAML fence).
  This schema validates only the metadata fields.

required:
  - id
  - title
  - date
  - spirit
  - medium
  - messageType
  - primarySubjects

properties:
  id:
    type: string
    description: >
      Unique identifier: YYYY-MM-DD-{MediumInitials}-{SpiritName}{-2|-3|...}
      - MediumInitials = first letters of the medium’s first and last names (capitalized), e.g., Al Fike → AF
      - SpiritName = standard capitalization, spaces replaced by hyphens, e.g., John-the-Beloved
      - Append -2, -3, ... if multiple messages share the same date/medium/spirit
    pattern: '^\d{4}-\d{2}-\d{2}-[A-Z]{2}-[A-Z][A-Za-z]*(?:-[A-Z][A-Za-z]*)*(?:-(?:[2-9]|[1-9]\d+))?$'

  title:
    type: string
    description: >
      Human-readable title. If curator-supplied (not from the original), append an asterisk *.

  date:
    type: string
    format: date
    description: Date the message was received (ISO 8601, YYYY-MM-DD).

  spirit:
    type: string
    description: >
      Spirit author’s full name in standard capitalization (e.g., "John the Beloved").
      Note: In the id, spaces become hyphens.

  medium:
    type: string
    description: >
      Human medium’s full name (e.g., "Al Fike"). MediumInitials in id derive from this (AF).

  location:
    type: object
    description: Place the message was received.
    required:
      - city
    properties:
      city:
        type: string
        description: City or locality (e.g., "Gibsons").
      region:
        type: [string, "null"]
        description: State/Province/Region (optional, e.g., "BC").
      country:
        type: [string, "null"]
        description: Country (optional, e.g., "Canada").
    additionalProperties: false

  messageType:
    type: array
    description: One or more labels describing the message; can include any/all of Blessing, Guidance, Teaching.
    items:
      type: string
      enum: ["Blessing", "Guidance", "Teaching"]
    uniqueItems: true
    minItems: 1

  description:
    type: string
    description: >
      Short (1–2 sentences) curator summary of the message’s purpose/insight.
    minLength: 1
    maxLength: 600

  primarySubjects:
    type: string
    description: >
      The single main subject from the “Hierarchy of Subjects in the Messages”.

  secondarySubjects:
    type: array
    description: Up to two additional subject tags (from the same hierarchy).
    items:
      type: string
    uniqueItems: true
    minItems: 0
    maxItems: 2

  people:
    type: array
    description: >
      Living people mentioned in or relevant to the message (exclude the medium).
    items:
      type: string
    uniqueItems: true
    default: []

  spirits:
    type: array
    description: >
      Spirits mentioned besides the primary spirit author.
    items:
      type: string
    uniqueItems: true
    default: []

  keywords:
    type: array
    description: Free-form topical tags (for search/browsing).
    items:
      type: string
      minLength: 1
      maxLength: 64
    uniqueItems: true
    default: []

  relatedMessages:
    type: array
    description: IDs of closely related messages.
    items:
      type: string
      pattern: '^\d{4}-\d{2}-\d{2}-[A-Z]{2}-[A-Z][A-Za-z]*(?:-[A-Z][A-Za-z]*)*(?:-(?:[2-9]|[1-9]\d+))?$'
    uniqueItems: true
    default: []

  audioUrl:
    type: [string, "null"]
    format: uri
    description: Optional link to audio recording (MP3/stream).

  canonicalUrl:
    type: [string, "null"]
    format: uri
    description: Optional permanent external URL for the officially published message.

  notes:
    type: [string, "null"]
    description: Optional curator notes or historical context.

additionalProperties: false
```
